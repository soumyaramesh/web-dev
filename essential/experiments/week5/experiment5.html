<! DOCTYPE html>
<html lang="en">
<head>
    <title>AngularJS Login</title>
    
    <script src="javascript/2.js"></script>
    <script src="javascript/NavController.js"></script>
    <script src="javascript/UserService.js"></script>
    <script src="javascript/ProfileController.js"></script>


    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <script src="javascript/angular.js"></script>
    <script src="javascript/angular-sanitize.js"></script>
    <script src="javascript/angular-route.js"></script>
    <script src="javascript/angular-route.min.js"></script>

</head>
<body ng-app="AngularApp">

    <div class="container">

        <!-- Fixed navbar -->
        <nav ng-controller="NavController" class="navbar navbar-default navbar-fixed-top">
            <div class="container">
               
                <div id="navbar" class="navbar-collapse collapse">
                    <ul class="nav navbar-nav">
                        <li><a href="#home">Home</a></li>
                        <li><a href="#about">About</a></li>
                        <li><a ng-show="currentUser" href="#profile_static">Profile</a></li>
                    </ul>


                    <form ng-show="!currentUser" class="navbar-form navbar-right">
                        <div class="form-group">
                            <input ng-model="username" type="text" placeholder="Username" class="form-control">
                        </div>
                        <div class="form-group">
                            <input ng-model="password" type="password" placeholder="Password" class="form-control">
                        </div>
                        <button ng-show="!currentUser" ng-click="login()" type="submit" class="btn btn-success">Sign in</button>
                    </form>
                    <form ng-show="currentUser" class="navbar-form navbar-right">
                        <label>Welcome {{currentUser.username}}</label>
                        <button ng-show="currentUser" ng-click="logout(currentUser.username)" type="submit" class="btn btn-danger">Logout</button>
                    </form>
                </div><!--/.nav-collapse -->
            </div>
        </nav>
        <!-- Fixed navbar ends-->


        <div ng-view>
        </div>

        <hr />
        <div>
            <h1>Login using AngularJS</h1>

            <p>
                Implemented basic login and logout using Factory and controllers in Angular JS. <br />
                If your current in Profile and you logout. You will be redirected to Home page using $location.path<br />
                Predefined credentails are
            </p>
            <div class="row">
                <div class="col-md-1">
                    <table class="table table-condensed">
                        <thead>
                            <tr>
                                <td>Username</td>
                                <td>Password</td>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>mit</td><td>mit</td></tr>
                            <tr><td>admin</td><td>admin</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>


            <b>Code Snippets</b><br /><br />
            <i>NavController.js:</i>
            <pre class="prettyprint">
                app.controller('NavController', ['$scope','UserService', function ($scope, UserService) {
    
    
                    $scope.login = function () {
                        var username = $scope.username;
                        var password = $scope.password;
                        var user = UserService.login(username, password);
                        $scope.currentUser = user;
                    }
                    $scope.logout = function () {
                        UserService.logout();
                        $scope.currentUser = null;
                        
                        /*Redirect to home*/
                        if ($location.path() == '/profile' || $location.path() == '/profile_static') {
                            $location.path('/home');
                        }
                    }
                }]);
            </pre>
            <i>UserService.js</i>
            <pre class="prettyprint">
                app.factory('UserService', function () {
                    var users = [
                        { username: 'mit', password: 'mit' },
                        { username: 'admin', password: 'admin' }];
                    var currentUser = null;
                    var login = function (username, password) {
                        for (var i = 0; i < users.length; i++) {
                            if (users[i].username == username) {
                                if (users[i].password == password) {
                                    currentUser = users[i];
                                    return users[i];
                                } else {
                                    return null;
                                }
                            }
                        }
                        return null;
                    }
                    var getCurrentUser = function(){
                        return currentUser;
                    }
                    var logout = function (username) {
                        currentUser = null;
                    }
                    return {
                        /*Expose the function*/
                        login: login,
                        getCurrentUser: getCurrentUser,
                        logout: logout
                    };
                });
            </pre>


        </div>
        <div>
            <b>Source Code:</b>
            <a href="http://net4.ccs.neu.edu/home/mit09/fileview/Default.aspx?~/experiments/angular_p/2.html" target="_blank">HTML</a>
            <b>|</b>
            <a href="http://net4.ccs.neu.edu/home/mit09/fileview/Default.aspx?~/experiments/angular_p/scripts/2.js" target="_blank"> Routing</a>
            <b>|</b>
            <a href="http://net4.ccs.neu.edu/home/mit09/fileview/Default.aspx?~/experiments/angular_p/scripts/NavController.js" target="_blank"> Controller</a>
            <b>|</b>
            <a href="http://net4.ccs.neu.edu/home/mit09/fileview/Default.aspx?~/experiments/angular_p/scripts/UserService.js" target="_blank"> Factory</a>
            <b>|</b>
            <a href="http://net4.ccs.neu.edu/home/mit09/fileview/Default.aspx?~/css/angular_app/1.css" target="_blank"> CSS</a>
            <br />
            <br />
            <b>References:</b>
            <ol>
                <li><a href="https://plus.google.com/u/0/events/clvi3kt97lvt3dhkhddvrm4nhqg" target="_blank">Prof. Jose lecture</a></li>
                <li><a href="https://code.google.com/p/google-code-prettify/" target="_blank"> Display code snippet using google-code-prettify</a></li>
                <li><a href="http://getbootstrap.com/getting-started/" target="_blank"> Bootstrap template</a></li>

            </ol>
        </div>
    </div>


</body>
</html>